---
title: HTTP notes
---

### 状态码

#### 1XX 信息性状态码（接受的请求正在处理）

#### 2XX 成功

- 204 No Content 返回的响应报文中不包含任何实体的主体。(可能场景:1. PUT请求但是文件已存在与服务器上； 2. DELETE请求 但是文件已经被删除了)
- 206 (Partial Content) 响应报文包含了多个范围的内容时使用。

#### 3XX 重定向（需要进行附加操作以完成请求）

- 301 Moved Permanently. 表示请求的资源已被分配了新的URI。
- 302 Found 临时性重定向。
- 303 See Other.表示由于请求对应的资源存在着另一个URI,应使用GET方法定向获取请求的资源。
  > 303和302功能相同,区别在于303状态码明确表示客户端应当采用GET方法获取资源.
- 304 Not Modified 表示客户端发送附带条件的请求时,服务器端允许请求访问资源,但未满足条件。不包含任何响应主体。虽被划分为3XX类别，但和重定向无关。
  > 附带条件的请求是指采用GET方法的请求报文中包含if-Match, If-Modified-Since, If-None-Match, If-Range, If-Unmodified-Since中任一首部。
-307 Temporary Redirect. 与302含义相同,区别在于307会按照浏览器标准,不会从POST变成GET.

#### 4XX 客户端错误（服务器无法处理请求）

- 400 Bad Request 请求报文中包含语法错误。
- 401 Unauthorized
- 403 Forbidden
- 404 Not Found.(场景  1: 服务器上无法找到请求的资源；2: 服务端拒绝请求且不想说明理由)

#### 5XX 服务端错误（服务器处理请求出错）

- 500 Internal Server Error
- 503 Service Unavailable

### HTTP方法

- OPTIONS: 用于查询针对请求URI资源所支持的方法
- TRACE: 追踪路径. 但是易引发XST(Cross-Site Tracing)攻击
- CONNECT: 要求用隧道协议连接代理

**代理**

- ‘中间人’角色。不改变请求URI
- 使用代理服务器的理由:利用缓存技术减少网络带宽的流量；针对特定网站的访问控制；获取访问日志
- 代理使用方法的分类基准: 1. 是否使用缓存；2.是否会修改报文

**网关**

- 与代理相似，而网关能使通信线路上的服务器提供非HTTP协议服务。
- 利用网关可以提高通信的安全性。
  
**隧道**

- 确保客户端能与服务端进行安全的通信。

**缓存**

- Vary. 使用Vary: User-Agent 可以用来区分移动端和桌面端的展示内容。
- 浏览器自带HTTP缓存实现,只需保证服务器响应提供了正确的HTTP标头指令，以指示浏览器何时可以缓存以及可以缓存多久。
- Webview页面需要提供额外的配置标志。
- 服务器使用ETag HTTP标头传递验证令牌。
- 验证令牌可实现高效的资源更新检查；资源未发生变化时不会传送任何数据。
- ETag解决的问题:浏览器发起资源请求->浏览器检查本地缓存找到之前的响应->响应过期->浏览器可以发出新的请求并获取完整的响应。这种方法效率很低,因为资源可能未发生变化。
- 验证令牌(ETag): 服务器生成并返回的随机令牌通常是文件内容的哈希值或其他指纹。客户端在下一次请求时将其发送至服务器，如果指纹仍然相同，则表示资源未发生变化，就可以跳过下载。
- 缓存策略

![缓存决策树](../assets/images/http-cache-decision-tree.png "缓存决策树")

- 废弃和更新缓存的响应
    - 在资源“过期”之前，将一直使用本地缓存的响应
    - 可以通过在网址中嵌入文件内容指纹，强制客户端更新到新版本的响应。
    - 为获得最佳性能，每个应用都需要定义自己的缓存层次结构。
### 杂记

- HTTP keep-alive: 只要任意一端没有明确提出断开连接,则保持TCP连接状态。好处:减少了TCP重复连接和断开所造成的额外开销,减轻服务端的负载；减少开销的那部分时间，使HTTP请求和响应能够更早的结束,从而提高了页面显示速度
- 持久连接使得多数请求以管线化(pipelining)方式发送成为可能
- 报文(message): 是HTTP通信中的基本单位,由8位组字节流(octet sequence, octet为8个bit)组成，通过HTTP通信传输。
- 实体(entity)作为请求或响应的有效载荷数据（补充项）被传输，其内容由实体首部和实体主体组成。
- MIME: Multipurpose Internet Mail Extensions
- 内容协商机制是指客户端和服务端就响应的资源内容进行交涉，然后提供给客户端最为合适的资源。内容协商以响应资源的语言、字符集、编码方式等作为判断的基准。
- no-cache: 为了防止从缓存中返回过期的资源。
- no-store: 禁止浏览器以及所有中间缓存存储任何版本的返回响应.
- HTTP加上加密处理和认证以及完整性保护后即是HTTPS
- HTTPS使用混合密钥加密:公开密钥和共享密钥相结合,在交换密钥环节使用公开密钥加密方式,之后的建立通信交换报文阶段则用共享密钥加密。
- 在Cookie中设置httponly属性可降低XSS攻击的损失。
- WebDAV(Web-based Distributed authoring and Versioning)是一个可对Web服务器上的内容直接进行文件复制、编辑等操作的分布式文件系统。
- CGI(Common Gateway Interface)是指web服务器在接收到客户端发送过来的请求后转发给程序的一组机制。
  